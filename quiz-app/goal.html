<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="format-detection" content="telephone=no" />
  <title>ゴール</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="quiz-container" role="main">
    <h1 class="app-title">ゴール！</h1>
    <section class="card glass">
      <p class="goal-lead">5つのキーワードをボタンで選んで、下のスロットに並べよう。</p>
      <p>蔵王ジャンプ台の別名は<br><strong>アリオンテック蔵王〇〇〇〇〇</strong></p>
      <div class="tips">
        <div class="tips-title">ヒント</div>
        <ul class="tip-list">
          <li class="tip">シャンツェ</li>
          <li class="tip">ャシンツェ</li>
          <li class="tip">ンツシェャ</li>
        </ul>
      </div>
      <div class="key-pool">
        <button class="chip" data-char="ツ" type="button">ツ</button>
        <button class="chip" data-char="ャ" type="button">ャ</button>
        <button class="chip" data-char="ェ" type="button">ェ</button>
        <button class="chip" data-char="シ" type="button">シ</button>
        <button class="chip" data-char="ン" type="button">ン</button>
      </div>
      <div class="slot-grid">
        <button class="slot" type="button"></button>
        <button class="slot" type="button"></button>
        <button class="slot" type="button"></button>
        <button class="slot" type="button"></button>
        <button class="slot" type="button"></button>
      </div>
      <div class="goal-actions">
        <button id="submit-final" class="btn" type="button">判定</button>
      </div>
      <div id="goal-feedback" class="feedback" aria-live="polite"></div>
      <a id="survey-link" class="btn link-btn hidden" href="https://forms.gle/mfHe6rbxjTjCdYtG6" target="_blank" rel="noopener">アンケートにご協力お願いします</a>
    </section>
<!-- 答え入力欄 -->
<input type="text" id="answer" placeholder="キーワードを入力" />

<!-- 判定ボタン -->
<button id="check-btn" class="btn" onclick="checkAnswer()">判定する</button>

<!-- アンケートボタン（最初は非表示） -->
<a id="survey-btn" class="btn hidden" href="https://forms.gle/mfHe6rbxjTjCdYtG6" target="_blank">
  アンケートにご協力お願いします
</a>

<!-- フィードバック表示 -->
<div id="goal-feedback"></div>
  </main>
  <script>
  (function(){
    const CORRECT = "シャンツェ";
    const chips = Array.from(document.querySelectorAll(".chip"));
    const slots = Array.from(document.querySelectorAll(".slot"));
    const feedback = document.getElementById("goal-feedback");
    const link = document.getElementById("survey-link");
    function getAnswer(){ return slots.map(s=>s.textContent.trim()).join(""); }
    function firstEmpty(){ return slots.find(s=>!s.textContent.trim()); }
    function clearSlot(slot){
      const ch = slot.textContent.trim();
      if(!ch) return;
      const target = chips.find(c=>c.dataset.char===ch && c.disabled);
      if(target) target.disabled=false;
      slot.textContent=""; slot.classList.remove("filled");
    }
    chips.forEach(chip=>{
      chip.addEventListener("click",()=>{
        const empty=firstEmpty(); if(!empty)return;
        empty.textContent=chip.dataset.char; empty.classList.add("filled");
        chip.disabled=true;
      });
    });
    slots.forEach(slot=>{ slot.addEventListener("click",()=>clearSlot(slot)); });
    document.getElementById("submit-final").addEventListener("click",()=>{
      const ans=getAnswer();
      if(ans===CORRECT){
        feedback.textContent="Congratulation!";
        feedback.classList.add("success-text");
        link.classList.remove("hidden");
      }else{
        feedback.textContent="答えが違うみたいだ...。キーワードをもう一度見直してみよう！";
        feedback.classList.remove("success-text");
        link.classList.add("hidden");
      }
    });
  })();
  </script>
</body>
</html>
